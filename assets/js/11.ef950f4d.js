(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{333:function(t,s,n){"use strict";n.r(s);var a=n(7),e=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"打包并上传到服务器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#打包并上传到服务器"}},[t._v("#")]),t._v(" 打包并上传到服务器")]),t._v(" "),s("p",[t._v("首先在根目录创建一个"),s("code",[t._v("deploy.sh")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/usr/bin/env sh")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 确保脚本抛出遇到的错误")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 生成静态文件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 进入生成的文件夹")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" dist\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("scp")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-r")]),t._v(" * web_test@39.104.48.98:/home/web_test/DLp/dist/DLpMHCI\n\n\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" -\n")])])]),s("p",[t._v("然后再去"),s("code",[t._v("package.json")]),t._v("里面修改成这个样子。")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[t._v("  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"serve"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue-cli-service serve"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"build"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue-cli-service build"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"deploy"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bash deploy.sh"')]),t._v("  #主要是加上这个\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),s("p",[t._v("这样代码写好之后，跑一下"),s("code",[t._v("npm run deploy")]),t._v("就o的k了。")]),t._v(" "),s("h2",{attrs:{id:"配置nginx"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置nginx"}},[t._v("#")]),t._v(" 配置nginx")]),t._v(" "),s("div",{staticClass:"language-editorconfig extra-class"},[s("pre",{pre:!0,attrs:{class:"language-editorconfig"}},[s("code",[t._v("server {\n\n    listen       80"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v(";")]),t._v("\n\t\n    server_name  www.jianglab.org.cn jianglab.org.cn 39.104.48.98"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v(";")]),t._v("\n    access_log /var/log/nginx/access.log"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v(";")]),t._v("\n    error_log /var/log/nginx/error.log"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v(";")]),t._v("\n\t\n\tlocation /{\n\t\tproxy_pass http://www.baidu.com"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v(";")]),t._v("\n\t}\n                                    \n\tlocation /DLpMHCI {\n\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#DLpMHC I的前端网页请求，转发至vue生产环境文件")]),t._v("\n\t\troot /home/web_test/DLp/dist"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v(";")]),t._v("\n\t\tindex index.html index.htm"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v(";")]),t._v("\n\t\t\n\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#转发代理，设置请求头允许跨域")]),t._v("\n\t\tadd_header 'Access-Control-Allow-Origin' *"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v(";")]),t._v("\n\t\tadd_header 'Access-Control-Allow-Credentials' 'true'"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v(";")]),t._v("\n\t\tadd_header 'Access-Control-Allow-Methods' *"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v(";")]),t._v("\n\t\tadd_header 'Access-Control-Allow-Headers' *"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v(";")]),t._v("\n\t}\n}\n\n")])])]),s("h2",{attrs:{id:"tip"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tip"}},[t._v("#")]),t._v(" tip")]),t._v(" "),s("p",[t._v("尤其要看文件的路径，这个特别有意思\n虽然在nginx里面写的root是"),s("code",[t._v("/home/web_test/DLp/dist")]),t._v("，但他实际上去"),s("code",[t._v("/home/web_test/DLp/dist/DLpMHCI")]),t._v("这个路径里面去寻找，也就是说在这个目录里面需要有一个叫做index.html的文件。")])])}),[],!1,null,null,null);s.default=e.exports}}]);