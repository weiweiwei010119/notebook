<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>加密（token和crypto） | weiwei的笔记本</title>
    <meta name="generator" content="VuePress 1.9.2">
    <link rel="icon" href="/notebook/img/favicon.ico">
    <script src="https://cdn.wwads.cn/js/makemoney.js" type="text/javascript"></script>
    <meta name="description" content="总之就是个笔记本">
    <meta name="keywords" content="vuepress,theme,blog,vdoing">
    <meta name="theme-color" content="#11a8cd">
    <meta name="wwads-cn-verify" content="6c4b761a28b734fe93831e3fb400ce87">
    
    <link rel="preload" href="/notebook/assets/css/0.styles.9fe6a187.css" as="style"><link rel="preload" href="/notebook/assets/js/app.8318a3f3.js" as="script"><link rel="preload" href="/notebook/assets/js/2.b4f7692e.js" as="script"><link rel="preload" href="/notebook/assets/js/9.64d46a2e.js" as="script"><link rel="prefetch" href="/notebook/assets/js/10.160ad3d9.js"><link rel="prefetch" href="/notebook/assets/js/11.ef950f4d.js"><link rel="prefetch" href="/notebook/assets/js/12.cada1122.js"><link rel="prefetch" href="/notebook/assets/js/13.37e18fd3.js"><link rel="prefetch" href="/notebook/assets/js/14.ea4d1d3c.js"><link rel="prefetch" href="/notebook/assets/js/15.6a981504.js"><link rel="prefetch" href="/notebook/assets/js/16.93f43160.js"><link rel="prefetch" href="/notebook/assets/js/17.837087e1.js"><link rel="prefetch" href="/notebook/assets/js/18.cb039bbe.js"><link rel="prefetch" href="/notebook/assets/js/19.09a42827.js"><link rel="prefetch" href="/notebook/assets/js/20.4f7d389b.js"><link rel="prefetch" href="/notebook/assets/js/3.805c644a.js"><link rel="prefetch" href="/notebook/assets/js/4.93cab1a5.js"><link rel="prefetch" href="/notebook/assets/js/5.7b109b5e.js"><link rel="prefetch" href="/notebook/assets/js/6.546e292c.js"><link rel="prefetch" href="/notebook/assets/js/7.76087f26.js"><link rel="prefetch" href="/notebook/assets/js/8.6ea66e8a.js">
    <link rel="stylesheet" href="/notebook/assets/css/0.styles.9fe6a187.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/notebook/" class="home-link router-link-active"><img src="/notebook/img/logo.png" alt="weiwei的笔记本" class="logo"> <span class="site-name can-hide">weiwei的笔记本</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/notebook/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="人工智能" class="dropdown-title"><!----> <span class="title" style="display:;">人工智能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>深度学习</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/notebook/pages/109tl/" class="nav-link">Pytorch</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="网页开发" class="dropdown-title"><!----> <span class="title" style="display:;">网页开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notebook/pages/5e05cf/" aria-current="page" class="nav-link router-link-exact-active router-link-active">综合技术</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常用工具" class="dropdown-title"><!----> <span class="title" style="display:;">常用工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notebook/pages/30101/" class="nav-link">Vuepress</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="本科毕设" class="dropdown-title"><!----> <span class="title" style="display:;">本科毕设</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notebook/pages/69c98f/" class="nav-link">开题准备</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/notebook/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="人工智能" class="dropdown-title"><!----> <span class="title" style="display:;">人工智能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>深度学习</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/notebook/pages/109tl/" class="nav-link">Pytorch</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="网页开发" class="dropdown-title"><!----> <span class="title" style="display:;">网页开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notebook/pages/5e05cf/" aria-current="page" class="nav-link router-link-exact-active router-link-active">综合技术</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常用工具" class="dropdown-title"><!----> <span class="title" style="display:;">常用工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notebook/pages/30101/" class="nav-link">Vuepress</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="本科毕设" class="dropdown-title"><!----> <span class="title" style="display:;">本科毕设</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notebook/pages/69c98f/" class="nav-link">开题准备</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端技术</span> <!----></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>后端技术</span> <!----></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>综合技术</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notebook/pages/5e05cf/" aria-current="page" class="active sidebar-link">加密（token和crypto）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/notebook/pages/5e05cf/#token" class="sidebar-link">token</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/notebook/pages/5e05cf/#前端" class="sidebar-link">前端</a></li><li class="sidebar-sub-header level3"><a href="/notebook/pages/5e05cf/#后端-python" class="sidebar-link">后端（python）</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/notebook/pages/5e05cf/#加密crypto" class="sidebar-link">加密crypto</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/notebook/pages/5e05cf/#前端-2" class="sidebar-link">前端</a></li><li class="sidebar-sub-header level3"><a href="/notebook/pages/5e05cf/#后端-python-2" class="sidebar-link">后端（python）</a></li></ul></li></ul></li><li><a href="/notebook/pages/f05c93/" class="sidebar-link">部署后端（flask+gunicorn+nginx）</a></li><li><a href="/notebook/pages/eaab77/" class="sidebar-link">部署前端（vue+nginx）</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/notebook/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>网页开发</span></li><li data-v-06225672><span data-v-06225672>综合技术</span></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/weiweiwei010119" target="_blank" title="作者" class="beLink" data-v-06225672>weiweiwei</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2022-09-24</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">加密（token和crypto）<!----></h1> <div class="theme-vdoing-content content__default"><h2 id="token"><a href="#token" class="header-anchor">#</a> token</h2> <h3 id="前端"><a href="#前端" class="header-anchor">#</a> 前端</h3> <p>token的解密和生成都是在后端完成的，但是前端需要在请求的时候存在SessionStorage中。</p> <ul><li>下面这个是储存。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">apitest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
</code></pre></div><ul><li>下面这个是调用。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">predictAttention</span><span class="token punctuation">(</span><span class="token punctuation">{</span>peptide<span class="token punctuation">,</span> <span class="token constant">HLA</span><span class="token punctuation">,</span><span class="token literal-property property">token</span><span class="token operator">:</span>sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>isToken<span class="token operator">===</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>tableData <span class="token operator">=</span> res<span class="token punctuation">.</span>tableData
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">drawLine</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>show <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ac <span class="token operator">=</span> <span class="token number">3</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>loading<span class="token operator">=</span><span class="token boolean">false</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>show <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;Page expired, please refresh again&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="后端-python"><a href="#后端-python" class="header-anchor">#</a> 后端（python）</h3> <div class="language-shell extra-class"><pre class="language-shell"><code>pip <span class="token function">install</span> PyJWT
</code></pre></div><p>然后打开python，写下下方的代码。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> jwt
<span class="token keyword">import</span> datetime

<span class="token keyword">def</span> <span class="token function">create_token</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    dic <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">'exp'</span><span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>utcnow<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> datetime<span class="token punctuation">.</span>timedelta<span class="token punctuation">(</span>minutes<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">#有效期，这个是5分钟</span>
        <span class="token string">'iat'</span><span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>utcnow<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">'iss'</span><span class="token punctuation">:</span> <span class="token string">'DLpMHCIweb'</span><span class="token punctuation">,</span>
        <span class="token string">'data'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    token <span class="token operator">=</span> jwt<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>dic<span class="token punctuation">,</span> <span class="token string">'jkhjgbjjkml987878567hmnfvghs'</span><span class="token punctuation">,</span> algorithm<span class="token operator">=</span><span class="token string">'HS256'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> token


<span class="token keyword">def</span> <span class="token function">decreate_token</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        payload <span class="token operator">=</span> jwt<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>token<span class="token punctuation">,</span> <span class="token string">'jkhjgbjjkml987878567hmnfvghs'</span><span class="token punctuation">,</span> algorithms<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'HS256'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>
</code></pre></div><p>使用则是非常简单，只需要这样就可以调用</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/dlpmhci/test'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    token <span class="token operator">=</span> create_token<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> token

</code></pre></div><h2 id="加密crypto"><a href="#加密crypto" class="header-anchor">#</a> 加密crypto</h2> <p>这个鬼东西要求前后端的解密加密方法一样才行☹️，这里尝试了很多种，最后采用了<a href="https://blog.csdn.net/xuanli4845/article/details/115895619" target="_blank" rel="noopener noreferrer">AES-CBC模式<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，此外填充方式为<a href="https://zhuanlan.zhihu.com/p/382530835" target="_blank" rel="noopener noreferrer">pkcs7<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
。</p> <h3 id="前端-2"><a href="#前端-2" class="header-anchor">#</a> 前端</h3> <p>首先安装一下包</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> crypto-js
</code></pre></div><p>接下来单独建立一个工具文件储存下面的东西</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> CryptoJS <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto-js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//引用AES源码js</span>

<span class="token keyword">const</span> key <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;wonibaba11201398&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//需要为16位</span>
<span class="token keyword">const</span> iv <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">'ABCDEF1234123412'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//偏移量也为16位</span>

<span class="token comment">//解密方法</span>
<span class="token keyword">function</span> <span class="token function">Decrypt</span><span class="token punctuation">(</span><span class="token parameter">word</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> encryptedHexStr <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Hex<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> srcs <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Base64<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>encryptedHexStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> decrypt <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span><span class="token constant">AES</span><span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>srcs<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">iv</span><span class="token operator">:</span> iv<span class="token punctuation">,</span> <span class="token literal-property property">mode</span><span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>mode<span class="token punctuation">.</span><span class="token constant">CBC</span><span class="token punctuation">,</span> <span class="token literal-property property">padding</span><span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>pad<span class="token punctuation">.</span>Pkcs7 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> decryptedStr <span class="token operator">=</span> decrypt<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> decryptedStr<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//加密方法</span>
<span class="token keyword">function</span> <span class="token function">Encrypt</span><span class="token punctuation">(</span><span class="token parameter">word</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> srcs <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> encrypted <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span><span class="token constant">AES</span><span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>srcs<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">iv</span><span class="token operator">:</span> iv<span class="token punctuation">,</span> <span class="token literal-property property">mode</span><span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>mode<span class="token punctuation">.</span><span class="token constant">CBC</span><span class="token punctuation">,</span> <span class="token literal-property property">padding</span><span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>pad<span class="token punctuation">.</span>Pkcs7 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> encrypted<span class="token punctuation">.</span>ciphertext<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    Decrypt <span class="token punctuation">,</span>
    Encrypt
<span class="token punctuation">}</span>
</code></pre></div><p>在项目工程中这么调用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> myCrypto <span class="token keyword">from</span> <span class="token string">&quot;@/utils/myCrypto&quot;</span><span class="token punctuation">;</span>
peptide<span class="token operator">=</span>myCrypto<span class="token punctuation">.</span><span class="token function">Encrypt</span><span class="token punctuation">(</span>peptide<span class="token punctuation">)</span>
</code></pre></div><h3 id="后端-python-2"><a href="#后端-python-2" class="header-anchor">#</a> 后端（python）</h3> <p>首先要安装crypto的包，但是crypto的安装在不同系统是不一样的，所以在<strong>部署服务</strong>时候需要格外注意。</p> <ul><li>在本地mac/win安装时执行下方的语句</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code>pip <span class="token function">install</span> pycryptodome
</code></pre></div><ul><li>在服务器上是这样的</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code>pip <span class="token function">install</span> pycrypto
</code></pre></div><p>首先写一个类</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives <span class="token keyword">import</span> padding
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>ciphers <span class="token keyword">import</span> algorithms
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES
<span class="token keyword">from</span> binascii <span class="token keyword">import</span> b2a_hex<span class="token punctuation">,</span> a2b_hex

<span class="token keyword">class</span> <span class="token class-name">PrpCrypt</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token string">'wonibaba11201398'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>mode <span class="token operator">=</span> AES<span class="token punctuation">.</span>MODE_CBC
        self<span class="token punctuation">.</span>iv <span class="token operator">=</span><span class="token string">'ABCDEF1234123412'</span> <span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>  <span class="token comment"># b'0102030405060708'</span>

    <span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">:</span>
        cryptor <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>self<span class="token punctuation">.</span>key<span class="token punctuation">,</span> self<span class="token punctuation">.</span>mode<span class="token punctuation">,</span> self<span class="token punctuation">.</span>iv<span class="token punctuation">)</span>
        text <span class="token operator">=</span> text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

        text <span class="token operator">=</span> self<span class="token punctuation">.</span>pkcs7_padding<span class="token punctuation">(</span>text<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>ciphertext <span class="token operator">=</span> cryptor<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>text<span class="token punctuation">)</span>
        <span class="token keyword">return</span> b2a_hex<span class="token punctuation">(</span>self<span class="token punctuation">.</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token decorator annotation punctuation">@staticmethod</span>
    <span class="token keyword">def</span> <span class="token function">pkcs7_padding</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token builtin">bytes</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            data <span class="token operator">=</span> data<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>
        padder <span class="token operator">=</span> padding<span class="token punctuation">.</span>PKCS7<span class="token punctuation">(</span>algorithms<span class="token punctuation">.</span>AES<span class="token punctuation">.</span>block_size<span class="token punctuation">)</span><span class="token punctuation">.</span>padder<span class="token punctuation">(</span><span class="token punctuation">)</span>
        padded_data <span class="token operator">=</span> padder<span class="token punctuation">.</span>update<span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">+</span> padder<span class="token punctuation">.</span>finalize<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> padded_data

    <span class="token decorator annotation punctuation">@staticmethod</span>
    <span class="token keyword">def</span> <span class="token function">pkcs7_unpadding</span><span class="token punctuation">(</span>padded_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        unpadder <span class="token operator">=</span> padding<span class="token punctuation">.</span>PKCS7<span class="token punctuation">(</span>algorithms<span class="token punctuation">.</span>AES<span class="token punctuation">.</span>block_size<span class="token punctuation">)</span><span class="token punctuation">.</span>unpadder<span class="token punctuation">(</span><span class="token punctuation">)</span>
        data <span class="token operator">=</span> unpadder<span class="token punctuation">.</span>update<span class="token punctuation">(</span>padded_data<span class="token punctuation">)</span>

        <span class="token keyword">try</span><span class="token punctuation">:</span>
            uppadded_data <span class="token operator">=</span> data <span class="token operator">+</span> unpadder<span class="token punctuation">.</span>finalize<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'no!'</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> uppadded_data

    <span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">:</span>
        cryptor <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>self<span class="token punctuation">.</span>key<span class="token punctuation">,</span> self<span class="token punctuation">.</span>mode<span class="token punctuation">,</span> self<span class="token punctuation">.</span>iv<span class="token punctuation">)</span>
        plain_text <span class="token operator">=</span> cryptor<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>a2b_hex<span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment"># return plain_text.rstrip('\0')</span>
        <span class="token keyword">return</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span>plain_text<span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token string">&quot;\x01&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span> \
            rstrip<span class="token punctuation">(</span><span class="token string">&quot;\x02&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token string">&quot;\x03&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token string">&quot;\x04&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token string">&quot;\x05&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span> \
            rstrip<span class="token punctuation">(</span><span class="token string">&quot;\x06&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token string">&quot;\x07&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token string">&quot;\x08&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token string">&quot;\x09&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span> \
            rstrip<span class="token punctuation">(</span><span class="token string">&quot;\x0a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token string">&quot;\x0b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token string">&quot;\x0c&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token string">&quot;\x0d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span> \
            rstrip<span class="token punctuation">(</span><span class="token string">&quot;\x0e&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token string">&quot;\x0f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token string">&quot;\x10&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">dict_json</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">:</span>
        j <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'&quot;: '</span><span class="token punctuation">,</span> <span class="token string">'&quot;:'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">', &quot;'</span><span class="token punctuation">,</span> <span class="token string">',&quot;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot;, {&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;,{&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> j

</code></pre></div><p>调用则非常简单了</p> <div class="language-python extra-class"><pre class="language-python"><code>pc <span class="token operator">=</span> PrpCrypt<span class="token punctuation">(</span><span class="token punctuation">)</span>
peptide <span class="token operator">=</span> pc<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>peptide_var<span class="token punctuation">)</span>
</code></pre></div></div></div>  <div class="page-edit"><!----> <!----> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><!----> <a href="/notebook/pages/f05c93/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">部署后端（flask+gunicorn+nginx）</div></a></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/notebook/pages/f05c93/">部署后端（flask+gunicorn+nginx）</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="weiweiwei010119@126.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/weiweiwei010119" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
    Copyright © 2022-2022
    <span>weiweiwei | GPL License</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/notebook/assets/js/app.8318a3f3.js" defer></script><script src="/notebook/assets/js/2.b4f7692e.js" defer></script><script src="/notebook/assets/js/9.64d46a2e.js" defer></script>
  </body>
</html>
